---
title: ARM架构学习笔记
date: 2025-03-10 20:42:21
tags: 学习笔记 ARM
---
# ARM架构学习笔记


## 一、计算机体系结构基础
### 1. 计算机指令
- **指令类型**：
  
  - 数据传输指令
  - 算术指令
  - 逻辑指令
  - 控制指令
- **指令集**：
  - **CISC（复杂指令集）**：指令复杂，单条指令完成多操作（如Intel x86）
  - **RISC（精简指令集）**：指令简单，固定长度，单周期执行（如ARM）
  
  > 区分arm和x86的重要特征，指令集须和芯片适配
  
  

### 2. CPU架构

- **冯·诺依曼结构**：
  - 程序与数据共享存储器
  - 单一总线分时访问
  - 典型应用：Intel/AMD处理器、ARM Cortex-A系列
- **哈佛结构**：
  - 程序与数据独立存储器
  - 双总线并行访问
  - 典型应用：ARM Cortex-M系列、51单片机
- **混合结构**：现代SoC普遍采用混合结构

### 3. CPU架构对比
| 架构   | 指令集类型 | 代表厂商       | 特点                     |
|--------|------------|----------------|--------------------------|
| x86    | CISC       | Intel/AMD      | 高性能，高功耗           |
| ARM    | RISC       | 苹果、华为     | 低功耗，移动端主导       |
| RISC-V | RISC       | 三星、英伟达   | 开源，灵活               |
| MIPS   | RISC       | 龙芯           | 低功耗，生态较弱         |
| LoongArch | 自研       | 龙芯           | 自主可控，生态建设中     |


## 二、ARM处理器体系结构
### 1. ARM概述
- **ARM公司**：1990年成立，专注IP核授权，不直接生产芯片
- **ARM架构特点**：
  - 体积小、低功耗、高性能
  - 支持Thumb/ARM双指令集
  - 大量寄存器，单周期指令
  - 加载/存储结构（Load/Store）

### 2. ARM体系结构版本
- **V1-V9**：
  - V7：主流版本，分为A/R/M系列
  - V8：首款64位架构
  - V9：增强安全、AI性能
  - V10：2023年发布，能效比提升

### 3. ARM处理器家族
- **Cortex-A系列**：应用处理器（如手机芯片）
- **Cortex-R系列**：实时处理器（如汽车电子）
- **Cortex-M系列**：微控制器（如STM32）


## 三、ARM处理器工作模式与状态
### 1. 工作模式
- **7种模式**：
  - 用户模式（USR）
  - 快速中断模式（FIQ）
  - 中断模式（IRQ）
  - 管理模式（SVC）
  - 中止模式（ABT）
  - 未定义模式（UND）
  - 系统模式（SYS）
- **特权模式**：除用户模式外的6种模式

### 2. 工作状态
- **ARM状态**：32位指令集
- **Thumb状态**：16位指令集（代码密度更高）
- **状态切换**：通过BX指令或异常处理自动切换


## 四、ARM寄存器组织
### 1. 寄存器分类
- **通用寄存器（31个）**：
  - R0-R7：未分组寄存器
  - R8-R14：分组寄存器（不同模式独立）
  - R15（PC）：程序计数器
- **状态寄存器（6个）**：
  - CPSR：当前程序状态寄存器
  - SPSR：异常程序状态保存寄存器

### 2. 寄存器功能
- **R13（SP）**：堆栈指针
- **R14（LR）**：链接寄存器（保存子程序返回地址）
- **CPSR标志位**：
  - N（负）、Z（零）、C（进位）、V（溢出）
  - I（IRQ禁止）、F（FIQ禁止）
  - T（Thumb状态标志）
  - M[4:0]（模式编码）


## 五、ARM存储器结构
### 1. 存储模式
- **小端模式**：低位字节存低地址
- **大端模式**：高位字节存低地址
- **默认**：小端模式

### 2. 数据类型
- 字节（8位）、半字（16位）、字（32位）、双字（64位）
- **对齐要求**：
  - 字：地址需4字节对齐
  - 半字：地址需2字节对齐


## 六、ARM流水线技术
### 1. 流水线级数
- **ARM7**：3级流水线（取指、译码、执行）
- **ARM9**：5级流水线（取指、译码、执行、缓冲、写回）
- **ARM10/11**：6/8级流水线

### 2. 流水线示例
- **三级流水线指令执行**：
  ```
  周期1: 取指(指令1)
  周期2: 译码(指令1) → 取指(指令2)
  周期3: 执行(指令1) → 译码(指令2) → 取指(指令3)
  ```


## 七、ARM异常中断处理
### 1. 异常类型
- 复位（Reset）
- 未定义指令（Undef）
- 软件中断（SWI）
- 预取中止（Prefetch Abort）
- 数据中止（Data Abort）
- 外部中断（IRQ）
- 快速中断（FIQ）

### 2. 异常向量表
| 异常类型       | 向量地址 | 优先级 |
|----------------|----------|--------|
| 复位           | 0x00     | 1      |
| 未定义指令     | 0x04     | 6      |
| SWI            | 0x08     | 6      |
| 预取中止       | 0x0C     | 5      |
| 数据中止       | 0x10     | 2      |
| IRQ            | 0x18     | 4      |
| FIQ            | 0x1C     | 3      |

### 3. 异常处理流程
1. 保存CPSR到SPSR
2. 设置模式为异常模式
3. 保存返回地址到LR
4. 跳转到异常向量地址
5. 执行异常处理程序
6. 恢复现场并返回


## 八、总结
- **ARM优势**：低功耗、高性能、灵活的IP授权模式
- **应用领域**：移动设备、嵌入式系统、物联网
- **发展趋势**：64位架构、AI加速、安全增强
